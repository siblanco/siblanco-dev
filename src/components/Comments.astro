---
interface Props {
  theme?: "dark" | "light" | "dark_dimmed" | "transparent_dark";
}

const { theme = "dark" } = Astro.props;
---

<section class="comments my-8 md:my-12">
  <h2 class="text-xl sm:text-2xl lg:text-3xl mb-4 font-medium">Kommentare</h2>
  <div class="giscus"></div>
</section>

<script is:inline>
  function loadGiscus() {
    const script = document.createElement("script");
    script.src = "https://giscus.app/client.js";
    script.dataset.repo = "siblanco/siblanco-dev";
    script.dataset.repoId = "R_kgDOLDp6tA";
    script.dataset.category = "Announcements";
    script.dataset.categoryId = "DIC_kwDOLDp6tM4CoFFk";
    script.dataset.mapping = "pathname";
    script.dataset.strict = "0";
    script.dataset.reactionsEnabled = "1";
    script.dataset.emitMetadata = "0";
    script.dataset.inputPosition = "bottom";
    script.dataset.theme = "dark";
    script.dataset.lang = "de";
    script.crossOrigin = "anonymous";
    script.async = true;

    const container = document.querySelector('.giscus');
    if (container) {
      container.innerHTML = '';
      container.appendChild(script);
    }
  }

  // Load Giscus after the page has fully loaded
  window.addEventListener('load', loadGiscus);

  // Handle theme changes if your site has theme switching functionality
  document.addEventListener('astro:after-swap', loadGiscus);
</script>

<style>
  .comments {
    border-top: 1px solid rgba(59, 186, 149, 0.2);
    padding-top: 2rem;
  }
  
  /* Ensures proper spacing when giscus loads */
  .giscus {
    min-height: 150px;
  }
</style>